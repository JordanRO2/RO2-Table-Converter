<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RO2 Table Converter - Community Tool</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Dropzone CSS -->
    <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        dark: {
                            bg: '#0f172a',
                            surface: '#1e293b',
                            card: '#334155',
                            border: '#475569',
                            text: '#f1f5f9',
                            muted: '#94a3b8'
                        }
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-dark-bg text-dark-text min-h-screen dark:bg-gray-900 dark:text-gray-100">
    <!-- Header -->
    <nav class="bg-dark-surface border-b border-dark-border dark:bg-gray-800 dark:border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-3">
                    <div class="bg-blue-600 p-2 rounded-lg">
                        <i class="fas fa-exchange-alt text-white"></i>
                    </div>                    <div>
                        <h1 class="text-xl font-semibold text-white">RO2 Table Converter</h1>
                        <p class="text-sm text-gray-400">Community Development Tool</p>
                    </div>
                </div>                <div class="flex items-center space-x-4">
                    <span class="bg-gray-700 px-3 py-1 rounded-full text-sm text-gray-300">v1.0</span>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Main Converter Section -->
        <div class="mb-12">
            <!-- File Converter -->
            <div>
                <div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
                    <div class="bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4">
                        <h2 class="text-xl font-semibold text-white flex items-center">
                            <i class="fas fa-file-exchange mr-3"></i>
                            File Converter
                        </h2>
                        <p class="text-blue-100 mt-1">Convert between CT and XLSX formats</p>
                    </div>
                    
                    <div class="p-6">
                        <!-- Upload Area -->
                        <div id="file-dropzone" class="border-2 border-dashed border-gray-600 hover:border-blue-500 transition-colors rounded-lg p-8 text-center bg-gray-700/30">
                            <div class="space-y-4">
                                <div class="text-blue-500">
                                    <i class="fas fa-cloud-upload-alt text-4xl"></i>
                                </div>
                                <div>
                                    <h3 class="text-lg font-medium text-white mb-2">Drop files here or click to select</h3>
                                    <p class="text-gray-400 text-sm">Supports .ct and .xlsx files (max 100MB each)</p>
                                    <p class="text-gray-500 text-xs mt-1">Automatic format detection • Bidirectional conversion</p>
                                </div>
                            </div>
                        </div>

                        <!-- Progress -->
                        <div id="progress-container" class="mt-6 hidden">
                            <div class="flex items-center justify-between mb-2">
                                <span class="text-sm text-gray-400">Processing files...</span>
                                <span id="progress-text" class="text-sm text-blue-400">0%</span>
                            </div>
                            <div class="w-full bg-gray-700 rounded-full h-2">
                                <div id="conversion-progress" class="bg-gradient-to-r from-blue-500 to-purple-500 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>

                        <!-- Results -->
                        <div id="results-container" class="mt-6 hidden">
                            <div class="border-t border-gray-700 pt-6">
                                <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                                    <i class="fas fa-check-circle text-green-500 mr-2"></i>
                                    Conversion Results
                                </h3>
                                <div id="results-list" class="space-y-3"></div>
                                <div class="flex space-x-3 mt-6">
                                    <button onclick="clearResults()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors flex items-center">
                                        <i class="fas fa-redo mr-2"></i>
                                        New Conversion
                                    </button>
                                    <button onclick="location.reload()" class="bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center">
                                        <i class="fas fa-sync mr-2"></i>
                                        Refresh
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Technical Information -->
        <div class="bg-gray-800 rounded-xl border border-gray-700 overflow-hidden">
            <div class="bg-gradient-to-r from-gray-700 to-gray-800 px-6 py-4">                <h2 class="text-xl font-semibold text-white flex items-center">
                    <i class="fas fa-info-circle mr-3"></i>
                    Technical Information
                </h2>
                <p class="text-gray-300 mt-1">Complete reference for RO2 Table Converter and CT file format</p>
            </div>

            <div class="p-6">
                <!-- Overview -->
                <div class="mb-8">
                    <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                        <i class="fas fa-document-text text-blue-500 mr-2"></i>
                        Overview
                    </h3>                    <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                        <p class="text-gray-300 mb-3">
                            Community-driven tool for converting between Ragnarok Online 2's proprietary CT (Compiled Table) format 
                            and Excel spreadsheets. Created by RO2 enthusiasts working to revitalize the game through private servers, 
                            client modifications, and community initiatives. Open to collaboration with Gravity Interactive and WarpPortal.
                        </p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-4">
                            <div class="bg-gray-800 p-3 rounded">
                                <h4 class="text-white font-medium mb-2">Conversion Capabilities</h4>
                                <ul class="text-gray-400 text-sm space-y-1">
                                    <li>• Bidirectional CT ↔ Excel conversion</li>
                                    <li>• Type preservation during conversion</li>
                                    <li>• Batch processing support</li>
                                    <li>• CRC-16 XMODEM checksum validation</li>
                                </ul>
                            </div>                            <div class="bg-gray-800 p-3 rounded">
                                <h4 class="text-white font-medium mb-2">Community Applications</h4>
                                <ul class="text-gray-400 text-sm space-y-1">
                                    <li>• Private server development</li>
                                    <li>• Client modifications & modding</li>
                                    <li>• Game data analysis & research</li>
                                    <li>• Custom content creation</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- CT File Format -->
                    <div>
                        <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                            <i class="fas fa-sitemap text-blue-500 mr-2"></i>
                            CT File Binary Structure
                        </h3>
                        <div class="bg-gray-700 rounded-lg overflow-hidden border border-gray-600">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-white font-medium">Offset</th>
                                        <th class="px-4 py-3 text-left text-white font-medium">Size</th>
                                        <th class="px-4 py-3 text-left text-white font-medium">Description</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-600">
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-blue-500/20 text-blue-400 px-2 py-1 rounded text-xs">0x00</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">16 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">Magic: "RO2SEC!" (UTF-16LE)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs">0x10</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">Variable</td>
                                        <td class="px-4 py-3 text-gray-400">Timestamp (UTF-16LE)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-purple-500/20 text-purple-400 px-2 py-1 rounded text-xs">-</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">Variable</td>
                                        <td class="px-4 py-3 text-gray-400">Padding to 64-byte boundary</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-orange-500/20 text-orange-400 px-2 py-1 rounded text-xs">0x40</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">Column count (DWORD)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-red-500/20 text-red-400 px-2 py-1 rounded text-xs">-</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">Variable</td>
                                        <td class="px-4 py-3 text-gray-400">Column names (STRING array)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-xs">-</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">Type count (DWORD)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-pink-500/20 text-pink-400 px-2 py-1 rounded text-xs">-</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">Variable</td>
                                        <td class="px-4 py-3 text-gray-400">Type codes (DWORD array)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-indigo-500/20 text-indigo-400 px-2 py-1 rounded text-xs">-</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">Row count (DWORD)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-teal-500/20 text-teal-400 px-2 py-1 rounded text-xs">-</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">Variable</td>
                                        <td class="px-4 py-3 text-gray-400">Data rows (binary encoded)</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-cyan-500/20 text-cyan-400 px-2 py-1 rounded text-xs">EOF-2</code>
                                        </td>
                                        <td class="px-4 py-3 text-gray-400">2 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">CRC-16 XMODEM checksum</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Data Types -->
                    <div>
                        <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                            <i class="fas fa-code text-green-500 mr-2"></i>
                            CT Data Types
                        </h3>
                        <div class="bg-gray-700 rounded-lg overflow-hidden border border-gray-600">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-900">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-white font-medium">Code</th>
                                        <th class="px-4 py-3 text-left text-white font-medium">Type</th>
                                        <th class="px-4 py-3 text-left text-white font-medium">Size</th>
                                        <th class="px-4 py-3 text-left text-white font-medium">Range</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-600">
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-blue-500/20 text-blue-400 px-2 py-1 rounded text-xs">2</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">BYTE</td>
                                        <td class="px-4 py-3 text-gray-400">1 byte</td>
                                        <td class="px-4 py-3 text-gray-400">0-255</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-green-500/20 text-green-400 px-2 py-1 rounded text-xs">3</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">SHORT</td>
                                        <td class="px-4 py-3 text-gray-400">2 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">-32,768 to 32,767</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-purple-500/20 text-purple-400 px-2 py-1 rounded text-xs">4</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">WORD</td>
                                        <td class="px-4 py-3 text-gray-400">2 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">0-65,535</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-orange-500/20 text-orange-400 px-2 py-1 rounded text-xs">5</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">INT</td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">±2.1 billion</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-red-500/20 text-red-400 px-2 py-1 rounded text-xs">6</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">DWORD</td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">0-4.3 billion</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-yellow-500/20 text-yellow-400 px-2 py-1 rounded text-xs">7</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">DWORD_HEX</td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">0x0-0xFFFFFFFF</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-pink-500/20 text-pink-400 px-2 py-1 rounded text-xs">8</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">STRING</td>
                                        <td class="px-4 py-3 text-gray-400">Variable</td>
                                        <td class="px-4 py-3 text-gray-400">UTF-16LE</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-indigo-500/20 text-indigo-400 px-2 py-1 rounded text-xs">9</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">FLOAT</td>
                                        <td class="px-4 py-3 text-gray-400">4 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">IEEE 754</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-teal-500/20 text-teal-400 px-2 py-1 rounded text-xs">11</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">INT64</td>
                                        <td class="px-4 py-3 text-gray-400">8 bytes</td>
                                        <td class="px-4 py-3 text-gray-400">64-bit integer</td>
                                    </tr>
                                    <tr>
                                        <td class="px-4 py-3">
                                            <code class="bg-cyan-500/20 text-cyan-400 px-2 py-1 rounded text-xs">12</code>
                                        </td>
                                        <td class="px-4 py-3 text-white">BOOL</td>
                                        <td class="px-4 py-3 text-gray-400">1 byte</td>
                                        <td class="px-4 py-3 text-gray-400">0 or 1</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- String Encoding & Checksum -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mt-8">
                    <div>
                        <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                            <i class="fas fa-font text-purple-500 mr-2"></i>
                            String Encoding Details
                        </h3>
                        <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Encoding</span>
                                    <span class="text-white font-mono">UTF-16LE</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Length Prefix</span>
                                    <span class="text-white font-mono">4-byte DWORD</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Null Termination</span>
                                    <span class="text-white font-mono">Not required</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Empty Strings</span>
                                    <span class="text-white font-mono">Length = 0</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div>
                        <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                            <i class="fas fa-shield-alt text-orange-500 mr-2"></i>
                            CRC-16 Checksum
                        </h3>
                        <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                            <div class="space-y-3">
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Algorithm</span>
                                    <span class="text-white font-mono">CRC-16 XMODEM</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Polynomial</span>
                                    <span class="text-white font-mono">0x1021</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Initial Value</span>
                                    <span class="text-white font-mono">0x0000</span>
                                </div>
                                <div class="flex justify-between">
                                    <span class="text-gray-400">Coverage</span>
                                    <span class="text-white font-mono">Row data only</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Usage Examples -->
                <div class="mt-8">
                    <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                        <i class="fas fa-terminal text-yellow-500 mr-2"></i>
                        Usage Examples
                    </h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                            <h4 class="text-white font-medium mb-2">Command Line Interface</h4>
                            <pre class="bg-gray-900 p-3 rounded text-sm text-green-400 overflow-x-auto"><code>python main.py CardInfo.ct
python main.py CardInfo.xlsx
python main.py ./game_data/</code></pre>
                        </div>
                        <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                            <h4 class="text-white font-medium mb-2">Python API</h4>
                            <pre class="bg-gray-900 p-3 rounded text-sm text-green-400 overflow-x-auto"><code>from asset.ct_processor import CTProcessor
processor = CTProcessor("file.ct")
data = processor.read()</code></pre>
                        </div>
                    </div>
                </div>

                <!-- Project Structure -->
                <div class="mt-8">
                    <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                        <i class="fas fa-folder-tree text-cyan-500 mr-2"></i>
                        Project Structure
                    </h3>
                    <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                        <pre class="text-gray-300 text-sm"><code>RO2-TableConverter/
├── app.py                 # Web interface (Flask)
├── main.py                # Command line interface
├── asset/
│   ├── ct_processor.py    # CT format handler
│   └── xlsx_processor.py  # Excel processor
├── templates/
│   └── index.html         # Web UI template
├── static/                # CSS/JS assets
└── requirements.txt       # Python dependencies</code></pre>
                    </div>
                </div>

                <!-- Git Repository -->
                <div class="mt-8">
                    <h3 class="text-lg font-medium text-white mb-4 flex items-center">
                        <i class="fab fa-github text-gray-400 mr-2"></i>
                        Repository
                    </h3>
                    <div class="bg-gray-700 rounded-lg p-4 border border-gray-600">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white font-medium">RO2 Toolkits</p>
                                <p class="text-gray-400 text-sm">Complete toolkit for Ragnarok Online 2 development</p>
                            </div>
                            <a href="https://github.com/JordanRO2/RO2_Toolkits" target="_blank" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors inline-flex items-center">
                                <i class="fab fa-github mr-2"></i>
                                View on GitHub
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 border-t border-gray-700 mt-12">        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex items-center justify-between">
                <div class="text-gray-400 text-sm">
                    RO2 Table Converter - Community Development Tool v1.0
                </div>
                <div class="text-gray-400 text-sm">
                    Built with ❤️ by the RO2 Community • Created by <a href="https://github.com/JordanRO2" target="_blank" class="text-blue-400 hover:text-blue-300 transition-colors">JordanRO2</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Loading Modal -->
    <div id="loading-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-gray-800 rounded-xl p-8 max-w-sm w-full mx-4 border border-gray-700">
            <div class="text-center">
                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full mx-auto mb-4 flex items-center justify-center">
                    <div class="w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                </div>
                <h3 class="text-lg font-medium text-white mb-2">Processing Files</h3>
                <p class="text-gray-400">Converting data format...</p>
            </div>
        </div>
    </div>

    <!-- Success Toast Template -->
    <div id="toast-template" class="hidden fixed top-4 right-4 bg-green-600 text-white px-6 py-4 rounded-lg shadow-lg z-50 transform translate-x-full transition-transform">
        <div class="flex items-center">
            <i class="fas fa-check-circle mr-2"></i>
            <span></span>
        </div>
    </div>    <!-- Scripts -->
    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
